
 /*-----------------AN√ÅLISES-----------------*/
 /*TOTAL DE PEDIDOS POR CLIENTE*/
 SELECT C.ClienteNomeCompleto, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimCliente AS C ON V.ClienteID = C.ClienteID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY C.ClienteNomeCompleto
 ORDER BY C.ClienteNomeCompleto

 /*CLIENTE COM MAIS PEDIDOS*/
 SELECT TOP 1 C.ClienteNomeCompleto, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimCliente AS C ON V.ClienteID = C.ClienteID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY C.ClienteNomeCompleto
 ORDER BY QTDE_PEDIDOS DESC

  /*CLIENTE COM MENOS PEDIDOS*/
 SELECT TOP 1 C.ClienteNomeCompleto, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimCliente AS C ON V.ClienteID = C.ClienteID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY C.ClienteNomeCompleto
 ORDER BY QTDE_PEDIDOS

 /*TOTAL DE PEDIDOS POR ANO*/
 SELECT T.ANO, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY T.ANO
 ORDER BY T.ANO

  /*TOTAL DE PEDIDOS POR MES, POR ANO*/
 SELECT T.ANO, T.MES, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY T.ANO, T.MES
 ORDER BY T.ANO, T.MES

 /*TOTAL DE PEDIDOS POR SEMESTRE DO ANO*/
 SELECT T.ANO, T.SEMESTRE, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY T.ANO, T.SEMESTRE
 ORDER BY T.ANO, T.SEMESTRE


