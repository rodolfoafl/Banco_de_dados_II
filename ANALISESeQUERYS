 /*TOTAL DE PEDIDOS POR CLIENTE*/
 SELECT C.ClienteNomeCompleto, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimCliente AS C ON V.ClienteID = C.ClienteID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY C.ClienteNomeCompleto
 ORDER BY QTDE_PEDIDOS

  /*CLIENTE COM MAIS PEDIDOS*/
 SELECT TOP 1 C.ClienteNomeCompleto, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimCliente AS C ON V.ClienteID = C.ClienteID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY C.ClienteNomeCompleto
 ORDER BY QTDE_PEDIDOS DESC

  /*CLIENTE COM MENOS PEDIDOS*/
  SELECT TOP 1 C.ClienteNomeCompleto, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimCliente AS C ON V.ClienteID = C.ClienteID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY C.ClienteNomeCompleto
 ORDER BY QTDE_PEDIDOS

 /*TOTAL DE PEDIDOS POR ANO*/
 SELECT T.ANO, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY T.ANO
 ORDER BY T.ANO

  /*TOTAL DE PEDIDOS POR MES, POR ANO*/
 SELECT T.ANO, T.MES, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY T.ANO, T.MES
 ORDER BY T.ANO, T.MES

 /*TOTAL DE PEDIDOS POR SEMESTRE DO ANO*/
 SELECT T.ANO, T.SEMESTRE, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY T.ANO, T.SEMESTRE
 ORDER BY T.ANO, T.SEMESTRE

 /*TOTAL DE PEDIDOS POR PAIS*/
  SELECT L.PAIS, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimLocal AS L ON V.LocalID = L.IDLOCAL
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY L.PAIS
 ORDER BY L.PAIS

 /*PAIS COM MAIS PEDIDOS*/
  SELECT TOP 1 L.PAIS, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimLocal AS L ON V.LocalID = L.IDLOCAL
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY L.PAIS
 ORDER BY QTDE_PEDIDOS DESC

  /*PAIS COM MENOS PEDIDOS*/
    SELECT TOP 1 L.PAIS, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimLocal AS L ON V.LocalID = L.IDLOCAL
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY L.PAIS
 ORDER BY QTDE_PEDIDOS

   /*TOTAL DE PEDIDOS POR CIDADE*/
  SELECT L.CIDADE, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimLocal AS L ON V.LocalID = L.IDLOCAL
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY L.CIDADE
 ORDER BY L.CIDADE

 /*CIDADE COM MAIS PEDIDOS*/
   SELECT TOP 1 L.CIDADE, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimLocal AS L ON V.LocalID = L.IDLOCAL
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY L.CIDADE
 ORDER BY QTDE_PEDIDOS DESC
 
  /*CIDADE COM MENOS PEDIDOS*/
   SELECT TOP 1 L.CIDADE, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimLocal AS L ON V.LocalID = L.IDLOCAL
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY L.CIDADE
 ORDER BY QTDE_PEDIDOS

 /*QUANTIDADE DE PEDIDOS POR PAIS POR ANO*/
 SELECT L.PAIS, T.ANO, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimLocal AS L ON V.LocalID = L.IDLOCAL
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA
 GROUP BY L.PAIS, T.ANO
 ORDER BY L.PAIS, T.ANO

 /*QUANTIDADE DE PEDIDOS POR CLIENTE POR ANO*/
 SELECT C.ClienteNomeCompleto, T.ANO, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimCliente AS C ON V.ClienteID = C.ClienteID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA
 GROUP BY C.ClienteNomeCompleto, T.ANO
 ORDER BY C.ClienteNomeCompleto, T.ANO, QTDE_PEDIDOS

 /*CLIENTE COM MAIS PEDIDOS NO ANO DE 2009, NO BRASIL*/
 SELECT TOP 1 C.ClienteNomeCompleto, T.ANO, L.PAIS, COUNT(DISTINCT V.PedidoID) AS QTDE_PEDIDOS
 FROM FatoVenda AS V
 LEFT JOIN DimCliente AS C ON V.ClienteID = C.ClienteID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 LEFT JOIN DimTempo AS T ON V.TempoID = T.IDDATA	
 LEFT JOIN DimLocal AS L ON V.LocalID = L.IDLOCAL
 WHERE T.ANO = '2009' AND L.PAIS = 'Brazil'
 GROUP BY C.ClienteNomeCompleto, T.ANO, L.PAIS
 ORDER BY QTDE_PEDIDOS DESC

 /*QUANTIDADE DE VENDAS POR MUSICA*/
 SELECT M.MusicaNome, COUNT(DISTINCT V.PedidoID) AS VENDAS
 FROM FatoVenda AS V
 LEFT JOIN DimMusica AS M ON V.MusicaID = M.MusicaID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY M.MusicaNome
 ORDER BY VENDAS DESC

 /*5 MUSICAS MAIS VENDIDAS*/
 SELECT TOP 5 M.MusicaNome, COUNT(DISTINCT V.PedidoID) AS VENDAS
 FROM FatoVenda AS V
 LEFT JOIN DimMusica AS M ON V.MusicaID = M.MusicaID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY M.MusicaNome
 ORDER BY VENDAS DESC

 /*QUANTIDADE DE VENDAS POR ARTISTA*/
 SELECT M.MusicaArtista, COUNT(V.PedidoID) AS VENDAS
 FROM FatoVenda AS V
 LEFT JOIN DimMusica AS M ON V.MusicaID = M.MusicaID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY M.MusicaArtista
 ORDER BY VENDAS DESC

  /*QUANTIDADE DE VENDAS POR GENERO*/
 SELECT M.MusicaGenero, COUNT(V.PedidoID) AS VENDAS
 FROM FatoVenda AS V
 LEFT JOIN DimMusica AS M ON V.MusicaID = M.MusicaID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY M.MusicaGenero
 ORDER BY VENDAS DESC

  /*QUANTIDADE DE VENDAS POR ALBUM POR ARTISTA*/
 SELECT M.MusicaAlbum, M.MusicaArtista, COUNT(V.PedidoID) AS VENDAS
 FROM FatoVenda AS V
 LEFT JOIN DimMusica AS M ON V.MusicaID = M.MusicaID
 LEFT JOIN DimPedido AS P ON V.PedidoID = P.PedidoID
 GROUP BY M.MusicaAlbum, M.MusicaArtista
 ORDER BY M.MusicaArtista, VENDAS DESC
