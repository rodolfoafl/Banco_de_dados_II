/*STORE PROCEDURES*/
/*LISTAR TODOS OS CLIENTES DE DETERMINADO PAIS*/
CREATE PROCEDURE sp_ClientesPais
@Pais VARCHAR(50)
AS 
BEGIN
	SELECT DISTINCT C.ClienteNomeCompleto FROM FatoVenda AS FV
	LEFT JOIN DimCliente AS C ON FV.ClienteID = C.ClienteID
	LEFT JOIN DimLocal AS L ON FV.LocalID = L.IDLOCAL
	WHERE L.PAIS = @Pais
END

EXEC sp_ClientesPais 'Brazil'

/*LISTAR CLIENTES QUE N√ÉO REALIZARAM NENHUM PEDIDO*/
CREATE PROCEDURE sp_ClientesSemPedidos
AS 
BEGIN
	SELECT DISTINCT C.ClienteNomeCompleto FROM DimCliente AS C
	WHERE C.ClienteID NOT IN (SELECT FV.ClienteID FROM FatoVenda AS FV)
END

EXEC sp_ClientesSemPedidos
